;var LINK_SERVER_ERROR='连接服务器失败，请稍后再试。';var mHeaderActs={prev:function(){},ltext:function(){},title:function(){},menu:function(){},rtext:function(){}};$(document).ready(function(){var $header=$('.m_header');if($header.length){$header.on('click','.bt_menu',function(){var _menu=$('.m_menu').removeClass('hidden');_menu.off('click').on('click',function(){_mask.click();});var _mask=Model.mask({color:'#ffffff',opacity:.01,zIndex:19,time:0});_mask.click(function(){_menu.addClass('hidden');_mask.remove();});}).on('click','.bt_menu',mHeaderActs.menu).on('click','.bt_prev',mHeaderActs.prev).on('click','.bt_ltext',mHeaderActs.ltext).on('click','.bt_rtext',mHeaderActs.rtext).on('click','.bt_title',mHeaderActs.title)};});var Model=(function(){function Model(){};Model.phoneCodeTime=60;Model.verify=function(){};Model.verify.realname=function(value){value=$.trim(value);if(value=='')return'请填写收货人的姓名';if(!/^[\u4e00-\u9fa5]{2,10}$/.test(value))return'请填写正确的收货人姓名';return'';};Model.verify.address=function(value){value=$.trim(value);if(value=='')return'请填写详细的收货地址';if(!/^.{5,40}$/.test(value))return'请填写正确的收货地址';return'';};Model.verify.zipcode=function(value){value=$.trim(value);if(value!=''){if(!/^\d+$/.test(value))return'请填写正确的邮政编码';};return'';};Model.verify.phone=function(value){value=$.trim(value);if(value==''){return'手机号码不能为空';};if(!/^\d{10,11}$/.test(value)){return'手机号码格式错误';};return'';};Model.verify.email=function(value){if(value==''){return'邮箱不能为空';};if(!/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(value)){return'邮箱格式错误';};return'';};Model.verify.imgcode=function(value){value=$.trim(value);if(value==''){return'图形验证码不能为空';};if(!/^.{4}$/.test(value)){return'图形验证码格式错误';};return'';};Model.verify.phonecode=function(value){value=$.trim(value);if(value==''){return'手机验证码不能为空';};if(!/^\d{6}$/.test(value)){return'手机验证码格式错误';};return'';};Model.verify.password=function(value){value=$.trim(value);if(value==''){return'密码不能为空';};if(!/^.{6,20}$/.test(value)){return'密码为6-20位数字与字母组合，区分大小写！';};if(value.indexOf(' ')>=0){return'密码不能包含空格';};if(/^((\d+)|([a-zA-Z]+)){1}$/.test(value)){return'密码太简单，请您更改密码，如字母+数字的组合';};return'';};Model.checkStrong=(function(){function CharMode(iN){if(iN>=48&&iN<=57){return 1;}else if((iN>=65&&iN<=90)||(iN>=97&&iN<=122)){return 2;}else{return 4;};};var modes;function bitTotal(num){modes=0;for(i=0;i<3;i++){if(num&1){modes++;}
num>>>=1;};return modes;};function checkStrong(sPW){if(Model.verify.password(sPW)){return 0;};modes=0;for(i=0;i<sPW.length;i++){modes|=CharMode(sPW.charCodeAt(i));};return bitTotal(modes);};return checkStrong;})();Model.time=function(){var d,s;d=new Date();s=d.getFullYear()+"-";s=s+(((d.getMonth()+1)>9)?(d.getMonth()+1):('0'+(d.getMonth()+1)))+"-";s+=((d.getDate()>9)?d.getDate():('0'+d.getDate()))+" ";s+=((d.getHours()>9)?d.getHours():('0'+d.getHours()))+":";s+=((d.getMinutes()>9)?d.getMinutes():('0'+d.getMinutes()))+":";s+=((d.getSeconds()>9)?d.getSeconds():('0'+d.getSeconds()));return s;};Model.timestamp=function(){return(new Date()).valueOf();};Model.guid=function(){var _guid='';for(var i=1;i<=32;i++){var n=Math.floor(Math.random()*16.0).toString(16);_guid+=n;if((i==8)||(i==12)||(i==16)||(i==20)){_guid+='-';};};return _guid;};Model.promise=function(fun){var self=this;self.queues=[];self.resolve=function(){var fun=self.queues&&self.queues[0];if(fun){var ret=fun.apply(self,arguments);self.queues.shift();if(ret&&ret.toString()=='promise'){ret.queues=self.queues;}else if(ret){self.resolve.apply(self,ret);};};return self;};self.then=function(fun){if(fun.constructor!==Function)return;self.queues.push(fun);return self;};self.toString=function(){return'promise';};if(fun)self.then(fun);};Model.mask=function(op){op=$.extend({color:'#000000',opacity:.5,zIndex:1000,time:500},op);return $('<div class="m_mask"></div>').css({'background-color':op.color,'opacity':op.opacity,'z-index':op.zIndex}).appendTo('body').fadeIn(op.time);};Model.message=function(message,time){time=time||3000;var message=$('<div class="m_message text-v">'+message+'</div>').appendTo('body');message.css({'margin-left':-message.width()/2,'margin-top':-message.height()/2});var isclose=false;var _setTimeout;if(time!=0){_setTimeout=setTimeout(function(){if(isclose)return;isclose=true;message.fadeOut(500,function(){message.remove();});},time);};return{close:function(){if(isclose)return;isclose=true;clearTimeout(_setTimeout);message.fadeOut(500,function(){message.remove();});},element:message};};Model.dialog=function(message,buttons){var _mask=Model.mask();var _dialog=$('<div class="m_dialog"><div class="content">'+message+'</div><div class="buttons"></div></div>').appendTo('body');var $buttons=_dialog.children('.buttons');$.each(buttons||[],function(index,button){button.click=button.click||function(){};$('<a class="m_button m_button_'+button.type+'" href="javascript:void(0)">'+button.text+'</a>').appendTo($buttons).click(button.click);});if(buttons.length==1){$buttons.addClass('only_one');};_dialog.css('margin-top',-_dialog.height()/2);return{close:function(){_dialog.remove();_mask.remove();},element:_dialog};};Model.confirm=function(message,callback,type){var dialog=Model.dialog(message,[{text:'取消',click:function(){dialog.close();}},{text:'确认',click:function(){if(callback){callback();};dialog.close();},type:type||'orange'}]);return dialog;};Model.alert=function(message,callback){var dialog=Model.dialog(message,[{text:'确认',click:function(){if(callback){callback();};dialog.close();},type:'orange'}]);return dialog;};return Model;})();if($('#js_lib_content').length){function resize(){$('#js_lib_content').css('min-height',($(window).height()-$('.m_header').height()-$('.m_footer').height())+'px');};$(window).resize(resize);resize();};$('.m_checkbox input[type="checkbox"],.m_radio input[type="radio"]').each(function(){if($(this).prop('checked')){$(this).parent().addClass('m_checked');}else{$(this).parent().removeClass('m_checked');};});$('.m_order_checkbox input[type="checkbox"]').each(function(){if($(this).prop('checked')){$(this).parent().addClass('m_checked');}else{$(this).parent().removeClass('m_checked');};});$('.m_setting input[type="checkbox"]').each(function(){if($(this).parent().hasClass('m_setting_password')){if($(this).prop('checked')){$(this).parent().addClass('m_settinged m_settinged_password');}else{$(this).parent().removeClass('m_settinged m_settinged_password');};}else{if($(this).prop('checked')){$(this).parent().addClass('m_settinged');}else{$(this).parent().removeClass('m_settinged');};};});$('.m_list input[type="text"],.m_list input[type="password"],.m_list textarea').each(function(){$(this).parent().find('.right .m_icon_del').hide();});$('.m_list .password .right .m_setting input[type="checkbox"]').each(function(){if($(this).prop('checked')){$(this).parent().parent().parent().children('input[type="password"],input[type="password"]').attr('type','text');}else{$(this).parent().parent().parent().children('input[type="password"],input[type="password"]').attr('type','password');};});$('.m_select select').each(function(index,el){if($(this).val()!=''&&$(this).val()!='0'){$(this).prev().html($(this).children('option:selected').html()).removeClass('gray');}else{$(this).prev().html($(this).children('option:selected').html()).addClass('gray');};});$('body').on('keyup','.m_list input[type="text"],.m_list input[type="password"],.m_list select,.m_list textarea',function(event){if(event.keyCode=='13'){var btn=$('#'+$(this).parents('.m_list').first().attr('from-submit')+':visible');if(!btn.hasClass('disabled')&&btn.attr('disabled')==null){btn.click();};};}).on('change','.m_radio input[type="radio"]',function(event){if($(this).prop('checked')){var name=$(this).attr('name');if(name){$('.m_radio input[type="radio"][name="'+name+'"]').each(function(){if($(this).prop('checked')){$(this).parent().addClass('m_checked');}else{$(this).parent().removeClass('m_checked');};});};$(this).parent().addClass('m_checked');}else{$(this).parent().removeClass('m_checked');};}).on('change','.m_checkbox input[type="checkbox"]',function(event){if($(this).prop('checked')){$(this).parent().addClass('m_checked');}else{$(this).parent().removeClass('m_checked');};}).on('change','.m_setting input[type="checkbox"]',function(event){if($(this).parent().hasClass('m_setting_password')){if($(this).prop('checked')){$(this).parent().addClass('m_settinged m_settinged_password');}else{$(this).parent().removeClass('m_settinged m_settinged_password');};}else{if($(this).prop('checked')){$(this).parent().addClass('m_settinged');}else{$(this).parent().removeClass('m_settinged');};};}).on('focus keyup','.m_list input[type="text"],.m_list input[type="password"],.m_list textarea',function(){if($(this).prop('readonly')||$(this).prop('disabled'))return;var value=$.trim($(this).val());if(!value){$(this).parent().find('.right .m_icon_del').hide();}else{$(this).parent().find('.right .m_icon_del').show();};}).on('blur','.m_list input[type="text"],.m_list input[type="password"],.m_list textarea',function(){$(this).parent().find('.right .m_icon_del').fadeOut(100);}).on('touchend mouseup','.m_list .right .m_icon_del',function(event){$(this).parent().parent().children('input[type="text"],input[type="password"],textarea').val('').change().focus();}).on('click','.m_list .imgcode .right .m_icon_reload',function(event){var src=$(this).prev().attr('data-src');$(this).prev().attr('src',src.replace(/@time/gim,Model.timestamp()));}).on('click','.m_list .imgcode .right img',function(event){var src=$(this).attr('data-src');$(this).attr('src',src.replace(/@time/gim,Model.timestamp()));}).on('change','.m_list .password .right .m_setting input[type="checkbox"]',function(event){if($(this).prop('checked')){$(this).parent().parent().parent().children('input[type="text"],input[type="password"]').attr('type','text');}else{$(this).parent().parent().parent().children('input[type="text"],input[type="password"]').attr('type','password');};}).on('change','.m_list .select-text select',function(event){$(this).parent().children('input[type="text"]').val($(this).val());}).on('change','.m_list .select-text input[type="text"]',function(event){$(this).parent().children('select').val('');}).on('change','.m_select select',function(event){if($(this).val()!=''&&$(this).val()!='0'){$(this).prev().html($(this).children('option:selected').html()).removeClass('gray');}else{$(this).prev().html($(this).children('option:selected').html()).addClass('gray');};}).on('click','#js_classify_all',function(){var $list=$(this).next('#js_classify_list');if($(this).data('open')=='no'){$list.removeClass('hidden').animate({'top':'0.93rem'},500);$(this).data('open','yes');Model.mask({color:'#000000',opacity:.5,zIndex:1,time:500});}else{$list.animate({'top':'0'},300).addClass('hidden');$(this).data('open','no');$(".m_mask").hide();}}).on('change','.m_order_checkbox input[type="checkbox"]',function(event){if($(this).prop('checked')){$(this).parent().addClass('m_checked');$('.m_opera').each(function(){$(this).data('select','on').addClass('selected');});}else{$(this).parent().removeClass('m_checked');$('.m_opera').each(function(){$(this).data('select','off').removeClass('selected');});};}).on('click','.m_opera',function(event){if($(this).data('select')=='off'){$(this).data('select','on').addClass('selected');}else{$(this).data('select','off').removeClass('selected');};});var goodsid_str='';$('body').on('click','#js_goods_delete',function(){$('#goods_list').addClass('show_delete');$('.goods_bottom').animate({"opacity":"1"},300);$(this).addClass('hidden');$('#js_delete_goods_ok').removeClass('hidden');}).on('click','#js_cancel',function(){$('.m_opera').each(function(){$(this).data('select','off').removeClass('selected');});}).on('click','#js_delete_goods_ok',function(){$('#goods_list').removeClass('show_delete');$('.goods_bottom').animate({"opacity":"0"},300);window.location.reload();}).on('click','#js_goods_maybe_delete',function(){var url=$('#js_goods_maybe_delete').data('url');$('.m_opera').each(function(){var goodsid=$(this).parent('.m_goods_cell').data('goodsid');if($(this).data('select')=='on'){goodsid_str=goodsid_str+goodsid+',';$(this).parent('.m_goods_cell').remove();};});if(goodsid_str==''){Model.message('请选择商品',1000);}else{$.ajax({url:url,type:'post',data:{goodsid_str:goodsid_str},dataType:'json',error:function(){Model.alert('服务器连接失败');},success:function(data){if(data.IsSuccess){Model.message("删除成功");if(data.isEmpty){window.location.reload();}}else{Model.message(data.Message);}}});}}).on('click','.m_icon_gotop',function(event){$(window).scrollTop(0);return false;});$('#js_order_search').click(function(){$('#js_order_searchbox').animate({'display':'block'},300);Model.mask({color:'#000000',opacity:.5,zIndex:10,time:300});});$('#js_search_cancel').click(function(){$('#js_order_searchbox').animate({'display':'none'},300);$(".m_mask").hide();})
$('#js_search_input').keyup(function(){if($(this).val()!=''){$("#js_search_cancel").addClass('hidden');$("#js_search_ok").removeClass('hidden');}else{$("#js_search_cancel").removeClass('hidden');$("#js_search_ok").addClass('hidden');}});var _notice_count=$('.p_notice_list li').length;var _count_i=1;function notice(){$('.p_notice_list').animate({'margin-top':'-'+(0.6*_count_i)+'rem'},500);if(_notice_count==1){$('.p_notice_list').css('margin-top','0');_notice_count=$('.p_notice_list li').length+1;_count_i=0;}
_notice_count--;_count_i++;}
var notice=setInterval(notice,3000);$(document).ready(function(){try{$('img[truesrc]').lazyload({threshold:$(window).height()});}
catch(ex){};});var loadings=[];$('.m_loading').each(function(index,el){loadings.push($(this));});function _run_loading($el,index){if($el.hasClass('m_loaded')){var url=$el.removeClass('m_loaded m_manually').data('url');var lastid=$el.data('lastid');var listid=$el.data('listid');var templateid=$el.data('template');window['TEMPLATE_D']=window['TEMPLATE_D']||{};var _template=window['TEMPLATE_D'][templateid]||(window['TEMPLATE_D'][templateid]=template.compile($('#'+templateid).html()));url=url.replace(/@lastid/g,lastid);$.ajax({url:url,dataType:'json',error:function(){$el.addClass('m_loaded');if(index!=null){loadings.splice(index,1);};},success:function(data){if(data.notMessage){if(window['add_class']){$('.lib_content .'+add_class).html(data.notMessage);}else{$('.lib_content').html(data.notMessage);}}else{if($el.data('count')){$el.data('count',$el.data('count')+1);}else{$el.data('count',1);};$el.addClass('m_loaded');$('#'+listid).append(_template({data:data})).find('img[truesrc]').lazyload({threshold:$(window).height()});if(data.isend==0){$el.data('lastid',data.lastid);if($el.data('count')>=999999){if(index!=null){loadings.splice(index,1);};$el.addClass('m_manually');if(!$el.children('a').length){$el.html('<a class="m_button m_button_radius js_check_more" href="javascript:void(0);">查看更多<i class="m_icon m_icon_loading"></i></a>');};if(!$el.data('bindclick')){$el.data('bindclick',true);$el.children('a.m_button_radius').click(function(){_run_loading($el);});};};}else{if(index!=null){loadings.splice(index,1);};};};}});};};var $gotop=$('.m_icon_gotop');function run_loading(){var height=$(window).height();var top=$(window).scrollTop();if(top>height/2){$gotop.removeClass('hidden');}else{$gotop.addClass('hidden');};var bottom=top+height*1.5;top-=height*.5;$.each(loadings,function(index,$el){var _top=$el.offset().top;if(_top>bottom){return false;}else if(_top>top){_run_loading($el,index);};});};$(window).scroll(run_loading);run_loading();;;;var _setInterval=setInterval(cutdown,1000);function cutdown(){var time=$('.js_time').data('time');var h=parseInt(time/(60*60))%24;var m=parseInt(time/60)%60;var s=time%60;$('.house').html(h<10?'0'+h:h);$('.minite').html(m<10?'0'+m:m);$('.second').html(s<10?'0'+s:s);if(time<=0){clearInterval(_setInterval);}
$('.js_time').data('time',--time);}
$(document).ready(function(){$('.m_zepto_slide').slide();});;;;(function($){var Queue=[];function loadimg(isimg,src,$element,srcProperty,outtime){try{var $img=$('<img/>').load(load).error(load);function load(){clearTimeout(_setTimeout);$img.unbind('load error');$img.remove();if(isimg){$element.attr('src',src).removeAttr(srcProperty);if($element.next().length&&$element.next()[0].nodeName.toUpperCase()=='DFN'){$element.parent().css({'background-image':'none'});};if($element.css('display')!='none'){$element.hide().stop(true,true).fadeIn();};}else{$element.css('background-image','url('+src+')').removeAttr(srcProperty);if($element.css('display')!='none'){$element.hide().stop(true,true).fadeIn();};};};var _setTimeout=setTimeout(load,outtime);$img.appendTo('body').hide().attr('src',src);}
catch(ex){if(isimg){$element.attr('src',src).removeAttr(srcProperty);if($element.next().length&&$element.next()[0].nodeName.toUpperCase()=='DFN'){$element.parent().css({'background-image':'none'});};}else{$element.css('background-image','url('+src+')').removeAttr(srcProperty);};};};function _run(lazyloadData){var length=0;if(length=lazyloadData.elements.length){var top=0;var left=0;var scrollTop=$(lazyloadData.settings.container).scrollTop()-lazyloadData.settings.threshold;var scrollLeft=$(lazyloadData.settings.container).scrollLeft()-lazyloadData.settings.threshold;var containerHeight=$(lazyloadData.settings.container).height()+lazyloadData.settings.threshold*2;var containerWidth=$(lazyloadData.settings.container).width()+lazyloadData.settings.threshold*2;if(lazyloadData.settings.container!==window){top=$(lazyloadData.settings.container).offset().top;left=$(lazyloadData.settings.container).offset().left;};for(var i=0;i<length;){var _top=lazyloadData.elements[i].offset().top-top;var _height=lazyloadData.elements[i].height();var _left=lazyloadData.elements[i].offset().left-left;var _width=lazyloadData.elements[i].width();if(_top>scrollTop+containerHeight){if(lazyloadData.settings.absolute){if(lazyloadData.settings.mode==='Row'){i+=lazyloadData.settings.rowItemNum;}else{i++;};}else{i=length;};}else if(_top+_height<scrollTop){if(lazyloadData.settings.mode==='Row'){i+=lazyloadData.settings.rowItemNum;}else{i++;};}else{length--;var _count=1;if(lazyloadData.settings.mode==='Row'){_count=lazyloadData.settings.rowItemNum;};while(_count--){var src=lazyloadData.elements[i].attr(lazyloadData.settings.srcProperty);var type=lazyloadData.elements[i][0].nodeName.toUpperCase();if(src){loadimg(type==='IMG',src,lazyloadData.elements[i],lazyloadData.settings.srcProperty,lazyloadData.settings.outTime);}else if(type!=='IMG'){lazyloadData.elements[i].find('['+lazyloadData.settings.srcProperty+']').each(function(){loadimg($(this)[0].nodeName.toUpperCase()==='IMG',$(this).attr(lazyloadData.settings.srcProperty),$(this),lazyloadData.settings.srcProperty,lazyloadData.settings.outTime);});};lazyloadData.elements.splice(i,1);}}};};};function windowscrollrun(lazyloadData){if(lazyloadData){_run(lazyloadData);}else{for(var i=Queue.length-1;i>=0;i--){if(Queue[i].elements.length){_run(Queue[i]);}else{Queue.splice(i,1);};};}};function windowscroll(){var _setTimeout=null;$(window).scroll(function(event){clearTimeout(_setTimeout);_setTimeout=setTimeout(function(){windowscrollrun();},100);});windowscroll=function(){};};$.fn.lazyload=function(options){var self=this;var settings={mode:'Single',itemSelecter:'>*',rowItemNum:1,threshold:0,container:window,outTime:5000,srcProperty:'truesrc',absolute:false};if(options){$.extend(settings,options);};var elements=[];if(settings.mode==='Row'){$(self).find(settings.itemSelecter).each(function(){elements.push($(this));});}else{$(self).each(function(){elements.push($(this));});};if(settings.container!==window){var _setTimeout=null;$(settings.container).scroll(function(){clearTimeout(_setTimeout);_setTimeout=setTimeout(function(){windowscrollrun({settings:settings,elements:elements});},100);});windowscrollrun({settings:settings,elements:elements});}else{Queue.push({settings:settings,elements:elements});windowscrollrun(Queue[Queue.length-1]);};windowscroll();return this;};})(jQuery);;;;(function($){$.fn.slide=function(stop){$.each($(this),function(){if(!$(this).hasClass('m_zepto_slide')){return;};var time,auto,index,oldindex,_setTimeout;time=$(this).attr('data-time')||'3000';auto=$(this).attr('data-auto')!='false';index=$(this).attr('data-index')||'0';if(!/^\d+$/.test(time))time='3000';if(!/^\d+$/.test(index))index='0';index=parseInt(index);time=parseInt(time);var $content=$(this).children('.content');var $items=$content.children();var $indexs=$(this).children('.index').children('a');var $next=$(this).children('.next');var $prev=$(this).children('.prev');var runing=false;if(index+1>$items.length)oldindex=index=0;function autorun(){if(runing)return;clearTimeout(_setTimeout);_setTimeout=setTimeout(function(){oldindex=index;if(++index>=$items.length)index=0;run();},time);};function loadimg(index){var $item=$items.eq(index);$item.find('[data-src]').each(function(){$(this).attr('src',$(this).attr('data-src')).removeAttr('data-src');});if($item.attr('data-src')){$item.css('background-image','url('+$item.attr('data-src')+')').removeAttr('data-src');};$item.find('[data-bgsrc]').each(function(){$(this).css('background-image','url('+$(this).attr('data-bgsrc')+')').removeAttr('data-bgsrc');});if($item.attr('data-bgsrc')){$item.css('background-image','url('+$item.attr('data-bgsrc')+')').removeAttr('data-bgsrc');};};function run(){runing=true;$indexs.removeClass('selected').eq(index).addClass('selected');$items.addClass('hidden').eq(index).css('z-index',2).removeClass('hidden').end().eq(oldindex).removeClass('hidden').css('z-index',1);if(index>oldindex){$items.eq(index).css({'left':'100%'}).animate({'left':0,marginLeft:0},{duration:400,queue:false});$items.eq(oldindex).css({'left':0}).animate({'left':'-100%',marginLeft:0},{duration:400,queue:false,complete:function(){runing=false;$items.eq(oldindex).addClass('hidden');if(auto){autorun();};}});}else{$items.eq(index).css({'left':'-100%'}).animate({'left':0,marginLeft:0},{duration:400,queue:false});$items.eq(oldindex).css({'left':0}).animate({'left':'100%',marginLeft:0},{duration:400,queue:false,complete:function(){runing=false;$items.eq(oldindex).addClass('hidden');if(auto){autorun();};}});};loadimg(index);};$indexs.removeClass('selected').eq(index).addClass('selected');$items.addClass('hidden').eq(index).removeClass('hidden');$indexs.tap(function(event){if($(this).hasClass('selected'))return false;if(runing)return;var _index=$indexs.index(this);if(_index>=$items.length)return false;oldindex=index;index=_index;run();return false;}).click(function(event){if($(this).hasClass('selected'))return false;if(runing)return false;var _index=$indexs.index(this);if(_index>=$items.length)return false;oldindex=index;index=_index;run();return false;});$prev.tap(function(){if(runing)return false;oldindex=index;if(--index<0)index=$items.length-1;run();return false;}).click(function(){if(runing)return false;oldindex=index;if(--index<0)index=$items.length-1;run();return false;});$next.tap(function(){if(runing)return false;oldindex=index;if(++index>=$items.length)index=0;run();return false;}).click(function(){if(runing)return false;oldindex=index;if(++index>=$items.length)index=0;run();return false;});var X=0;var _X=0;var _X2=0;var touchTime=0;$content.on('touchstart',function(e){if(runing)return;touchTime=(new Date()).valueOf();clearTimeout(_setTimeout);X=e.changedTouches[0].clientX;$items.addClass('hidden').animate({left:0},{duration:0,queue:false});$items.eq(index-1).removeClass('hidden').css({left:'-100%',marginLeft:0});$items.eq(index+1).removeClass('hidden').css({left:'100%',marginLeft:0});$items.eq(index).removeClass('hidden').css({left:0,marginLeft:0});loadimg(index+1);loadimg(index-1);loadimg(index);if(!$content.attr('data-link')){e.preventDefault();};}).on('touchmove',function(e){if(runing)return;_X2=_X;_X=e.changedTouches[0].clientX;touchTime=(new Date()).valueOf();$items.eq(index-1).css({marginLeft:_X-X});$items.eq(index+1).css({marginLeft:_X-X});$items.eq(index).css({marginLeft:_X-X});e.preventDefault();}).on('touchend touchcancel',function(e){if(runing)return;var x=e.changedTouches[0].clientX;var _time=(new Date()).valueOf();var type=0;if(_time-touchTime>50){if(x-X>$content.width()/2){type=-1;}else if(x-X<-$content.width()/2){type=1;}else{$items.eq(index-1).animate({marginLeft:0},{duration:400,queue:false});$items.eq(index+1).animate({marginLeft:0},{duration:400,queue:false});$items.eq(index).animate({marginLeft:0},{duration:400,queue:false});};}else{if(x>((x==_X)?_X2:_X)){type=-1;}else{type=1;};};if(type!=0){if(index+type<0||type+index>=$items.length){$items.eq(index-1).animate({marginLeft:0},{duration:400,queue:false});$items.eq(index+1).animate({marginLeft:0},{duration:400,queue:false});$items.eq(index).animate({marginLeft:0},{duration:400,queue:false});}else{oldindex=index;index+=type;run();return;};};if(!$content.attr('data-link')){e.preventDefault();};});if(auto){autorun();};setTimeout(function(){loadimg(0);},10);});return this;};})(jQuery);;