define("api/jifen",["lib/common","config/url"],function(e,t){return{info:{apiName:"pointGetpointinfo",isOnlyData:1,post:{token:e.cookie.getH5("token"),cityCode:e.cookie.getH5("siteid"),areaCode:e.cookie.getH5("siteid"),body:"??"},body:{},method:"post"},point:{apiName:"pointGetpoint",isOnlyData:1,post:{token:e.cookie.getH5("token"),cityCode:e.cookie.getH5("siteid"),areaCode:e.cookie.getH5("siteid"),body:"??"},body:{pageIndex:"?",onePageSize:"?",type:"?"},method:"post"}}}),define("model/jifen/index",["lib/common","api/jifen"],function(e,t){function n(n,r){var n=n||{},i={token:n.token,cityCode:n.cityCode,channel:n.channel,clientid:n.clientid,view_size:n.view_size,body:{}};n.body&&e.merge(i.body,n.body),e.xsr(e.makeUrl(t.info,i),function(e){try{r&&r(e)}catch(t){throw t}})}function r(n,r){var n=n||{},i={token:n.token,cityCode:n.cityCode,body:{pageIndex:n.pageIndex,onePageSize:n.pageSize,type:n.type}};n.body&&e.merge(i.body,n.body),e.xsr(e.makeUrl(t.point,i),function(e){try{r&&r(e)}catch(t){throw t}})}return{info:n,point:r}}),define("widget/timeDeal",[],function(){function s(s,o,a){var l,c,h,p,d=0,v=s+"_"+o,m={day:"0",hour:"00",min:"00",sec:"00",base:0};return i[v]?d=i[v]:(typeof o=="undefined"?(d=s*1,!d&&d!=0&&(d=u(s).getTime())):d=u(o).getTime()-u(s).getTime(),i[v]=d),d-=(d>=0?a:-a)||0,m.base=d,d=Math.abs(d),d>0&&(l=d/e>>0,c=(d-l*e)/t>>0,h=(d-l*e-c*t)/n>>0,p=(d-l*e-c*t-h*n)/r>>0,m.day=f(l,m.day.length),m.hour=f(c,m.hour.length),m.min=f(h,m.min.length),m.sec=f(p,m.sec.length)),m}function o(i){var s,o,u,a,l=i||0,c={day:"0",hour:"00",min:"00",sec:"00",base:0};return c.base=l,l=Math.abs(l),l>0&&(s=l/e>>0,o=(l-s*e)/t>>0,u=(l-s*e-o*t)/n>>0,a=(l-s*e-o*t-u*n)/r>>0,c.day=f(s,c.day.length),c.hour=f(o,c.hour.length),c.min=f(u,c.min.length),c.sec=f(a,c.sec.length)),c}function u(e){try{var t;if(typeof e=="object"&&typeof e.getTime=="function")return e;e>>0?e.toString().length==10?e*=1e3:e*=1:e=e.replace(/-/g,"/");if(e){t=new Date(e);if(t!="Invalid Date")return t;console.warn("日期格式错误:",e)}else console.warn("不能为空!")}catch(n){console.warn(n)}}function a(e,t){var n,r,i={},t=t||"!y-M-d h:m:s.S",s=u(e);if(s){i={y:s.getFullYear(),M:s.getMonth()+1,d:s.getDate(),h:s.getHours(),m:s.getMinutes(),s:s.getSeconds(),q:Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()},t.charAt(0)==="!"?(n=f,t=t.slice(1)):n=function(e,t){return("00000"+e).slice(-t)};for(r in i)(new RegExp("("+r+"+)")).test(t)&&(t=t.replace(RegExp.$1,n(i[r],RegExp.$1.length)));return i.fmt=t,i}}function f(e,t){for(var n=e.toString().length;n<t;n++)e="0"+e;return e}var e=864e5,t=36e5,n=6e4,r=1e3,i={};return{setTime:s,setTime2:o,getDate:a,patchZero:f,examine:u}}),function(e){function t(t){function n(){if(this.udid)return this.udid;var e="",t=this.getTime();return e+="H5_"+t+this.randomString(10),this.udid=e,e}t=t||{},this.ua=navigator.userAgent,this.udid="",this.env=null,this.resolution=e.screen.width+"|"+e.screen.height,this.cookieDomain=function(){var e=/m\.feiniu\.com/i.test(location.href);return e?".feiniu.com":location.hostname.split(".").slice(-2).join(".")},this.getTime=function(){return(new Date).getTime()},this.randomString=function(e){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split("");e||(e=Math.floor(Math.random()*t.length));var n="";for(var r=0;r<e;r++)n+=t[Math.floor(Math.random()*t.length)];return n},this.createUdid=typeof t.createUdid=="function"?t.createUdid:n,this.getcookie=function(e){var t=new RegExp("(^|;|\\s+)"+e+"=([^;]*)(;|$)"),n=document.cookie.match(t);return n?decodeURIComponent(n[2]):""},this.addcookie=function(e,t,n,r,i){var s=e+"="+encodeURIComponent(t)+"; path="+(n||"/")+(i?"; domain="+i:"");if(r>0){var o=new Date;o.setTime(o.getTime()+r*1e3),s+=";expires="+o.toGMTString()}document.cookie=s},this.delcookie=function(e,t,n){arguments.length==2&&(n=t,t="/"),document.cookie=e+"=;path="+t+";"+(n?"domain="+n+";":"")+"expires=Thu, 01-Jan-70 00:00:01 GMT"},this.getUdid=function(){var e="th5_stat_udid",t=this.getcookie(e);if(t)return t;var n=this.createUdid(),r=31536e3,i=/feiniu\.com/i.test(location.href),s=".feiniu.com";return i||(s=location.hostname.split(".").slice(-2).join(".")),this.addcookie(e,n,"/",r,s),n},this.getEnv=function(){if(this.env!=null)return this.env;var e=["m","preview","test","dev","dev1","local"],t="m",n=location.hostname.split(".");if(n[0])for(var r in e)if(e[r]==n[0]){t=n[0];continue}return this.setEnv(t),t},this.setEnv=function(e){this.env=e},this.getSystemType=function(){var e=this.ua;e=e.toLowerCase();var t="";return e.indexOf("android")>-1||e.indexOf("linux")>-1?t="android":e.indexOf("iphone")>-1||e.indexOf("ipad")>-1||e.indexOf("itouch")>-1||e.indexOf("ipod")>-1||e.indexOf("mac")>-1?t="ios":e.indexOf("windows phone")>-1?t="wp":t="windows",t},this.mix=function(){var e={};for(var t=0;t<arguments.length;t++){var n=arguments[t];for(var r in n)r in e?n[r]!=undefined&&(e[r]=n[r]):e[r]=n[r]}return e},this.getUrlParam=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=location.search.substr(1).match(t);return n!=null?decodeURIComponent(n[2]):null},this.getMessage=function(){var e=this.getUrlParam("fromtype");return e==null&&(e=document.referrer?document.referrer:""),e},this.getRemarksCfg=function(){var e={terminal_os_ver:"",model:"",brand:"",resolution:this.resolution,browser_type:"",mac:""};return JSON.stringify(this.mix(e))},this.isClient=function(){var e="th5_stat_token",t=86400,n=this.getcookie("th5_token")||"",r=this.getcookie("th5_stat_token")||"";if(n&&r==n)return"";if(r=="-1")return n&&this.addcookie(e,n,"/",t,this.cookieDomain()),"";if(r!=n||!r){var n=n||"-1";this.addcookie(e,n,"/",t,this.cookieDomain())}return this.getRemarksCfg()};var r=this.getTime(),i=this.getcookie("th5_username")||"",s=this.getcookie("th5_sitename")||"",o=this.getcookie("th5_mem_guid")||"";!o&&i&&(o=i),this.getLandingUrl=function(){var t="th5_landing_url",n=this.getcookie(t)||"",r=1800;if(n)return this.addcookie(t,n,"/",r,this.cookieDomain()),n;var i=e.location.href;return this.addcookie(t,i,"/",r,this.cookieDomain()),i},this.getLandingSession=function(){var e="th5_landing_session",t=this.getcookie(e)||"",n=1800;if(t)return this.addcookie(e,t,"/",n,this.cookieDomain()),t;var r="";return r+="H5_"+this.getTime()+this.randomString(10),this.addcookie(e,r,"/",n,this.cookieDomain()),r},this.setLandingSession=function(e){var t="th5_landing_session",n=1800;this.addcookie(t,e,"/",n,this.cookieDomain())},this.getAppid=function(){var e=navigator.userAgent;e=e.toLowerCase();if(navigator.userAgent.indexOf("feiniuapp")>-1){var t=navigator.userAgent.split(" ");for(var n=0;n<t.length;n++)if(t[n].indexOf("feiniuapp")>-1){var r=t[n].split("/"),i=r[1].toLowerCase();if(i=="android")return 1;if(i=="iphone")return 2;if(i=="ipad")return 4;if(i=="winphone")return 5}}else{if(this.getUrlParam("osType")&&this.getUrlParam("osType")!="")return e.match(/MicroMessenger/i)=="micromessenger"?9:this.getUrlParam("osType");if(e.match(/MicroMessenger/i)=="micromessenger")return 9}return 3},this.statAppVal=function(){var e={},t=this.getcookie("th5_stat_app");if(t)try{e=JSON.parse(t)}catch(n){}if(typeof e=="undefined"||!e)e={};return e},this.urlConfigParam={udid:this.getUdid(),mem_guid:o,user_name:i,terminal_os:this.getSystemType(),track_code:this.getcookie("th5_channel_edm_code")||"",network:"",gps:"",city:s,track_tag_name:"",result:"",page_content:"",message:"",cur_req_url:location.href,landing_url:"",session_id:"",track_type:1,referer_url:document.referrer||"",startTime:r,endTime:r,abtest:0,remarks:"",ver:"",traffic_channel:"",dev_type:this.getAppid(),ref_page_id:"",client_type:0},this.shangbao=function(t,n,r){var i="",s=this.getEnv();s=="m"?i="http://flume.feiniu.com/AppCollectLogs/AddH5Log?v="+this.getTime():s=="preview"?i="/stat.php?env=preview&v="+this.getTime():i="/stat.php?env=test&v="+this.getTime(),i+=this.randomString(2);var t=t||{};t.message=="-9"&&(t.message=this.getMessage());var o=this.statAppVal();typeof o=="object"&&(t.client_type=o.client_type,t.ver=o.ver,t.traffic_channel=o.traffic_channel,t.gps=o.gps,t.network=o.network,o.session_id&&this.setLandingSession(o.session_id)),t.landing_url=this.getLandingUrl(),t.session_id=this.getLandingSession();var u=this.mix(this.urlConfigParam,t);for(j in u)u[j]=="-9"&&(u[j]="0"),i+="&"+j+"="+encodeURIComponent(u[j]);typeof n!="function"&&(n=function(){});if(navigator.sendBeacon)navigator.sendBeacon(i,""),n();else{var a=new Image,f;try{var l=new $.Deferred,c=function(){a.removeEventListener("load",c,!1),a.removeEventListener("error",c,!1),clearTimeout(f),n(),l.resolve()};a.addEventListener("load",c,!1),a.addEventListener("error",c,!1),f=setTimeout(c,r||1e3),a.src=i,e._deferRedirect=l}catch(h){a.src=i,n()}}}}var n={isObj:0,shangbao:function(e,n,r){var i="";if(this.isObj)i=this.isObj;else{i=new t(this.opt),this.isObj=i;if(e.h5_type=="edm"){if(i.getUrlParam("tracking_type")!="h5_edm")return"";var s=i.getUrlParam("type");(s=="h5_dev"||s=="h5_test"||s=="h5_beta")&&i.setEnv("test")}var o=i.isClient();if(o){var u={track_tag_name:"1000",result:"",page_content:"",message:"-9",track_type:"6",remarks:o};i.shangbao(u,n,r)}}i.shangbao(e,n,r)},getRemarksCfg:function(){var e="";return this.isObj?e=this.isObj:(e=new t,this.isObj=e),e.getRemarksCfg()}};e.h5stat=n;if(typeof define=="function"&&define.amd)define("widget/stat",["lib/common"],function(t){return e.h5stat});else if(typeof e.Zepto=="undefined"){var r=document.createElement("script");r.src=e.feiniu.url.jsBase+"/lib/zepto.min.js";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(r,i)}}(window),require(["lib/common","model/jifen/index","widget/timeDeal","widget/stat"],function(e,t,n,r){function f(){e("#blank").addClass("hide_it"),e("#nomorepoint").addClass("hide_it")}function l(e){u=e,firstLoad=i[u].firstLoad,firstLoad&&h(1,u)}function h(n,r){var l="",h={token:e.cookie.getH5("token"),cityCode:e.cookie.getH5("siteid")||1,body:{pageIndex:n,onePageSize:"10",type:--r}};e(".load_more").show(),i[u].firstLoad=!1,f(),t.point(h,function(t){var n=t.body.type+1;e(".load_more").hide(),e.log(t),o=t&&t.errorCode===0&&t.body,o?(e("#all_score").text(t.body.allScore),e("#wait_score").text(t.body.waitScore),e("#expire_score").text(t.body.expireScore),t.body.pointList.length===0?(e("#nomorepoint").addClass("hide_it"),e(".blank").removeClass("hide_it"),e(".marg_tb60").html("<p>您暂时还没有任何积分</p><p>可以去首页逛逛</p>")):(e(".blank").addClass("hide_it"),i[n].totalPage=t.body.total_page,e.tplRender("tpl_list_"+n,t.body),s=!1,c(),i[n].currentPage===t.body.total_page?(e("#nomorepoint").removeClass("hide_it"),i[n].isnomorepoint=1):e("#nomorepoint").addClass("hide_it")),i[n].loaded=!0):(l=t.errorDesc||"网络错误",t.errorCode!==0?(e(".blank").removeClass("hide_it"),e(".marg_tb60").html("<p>"+l+"</p>")):(e(".load_more").hide(),e(".marg_tb60").html("<p>"+l+"</p>")))}),e("#all_score").text(a.allScore),e("#wait_score").text(a.waitScore),e("#expire_score").text(a.expireScore)}var i=new Array;i[1]={firstLoad:!0,currentPage:1,totalPage:0,isnomorepoint:0,loaded:!1},i[2]={firstLoad:!0,currentPage:1,totalPage:0,isnomorepoint:0,loaded:!1},i[3]={firstLoad:!0,currentPage:1,totalPage:0,isnomorepoint:0,loaded:!1};var s=!1,o=!1,u=1,a={allScore:0,waitScore:0,expireScore:0};e("#J_il_nav").on("click","a",function(){f();var t=e(this);_sw=t.data("list"),t.addClass("active").siblings().removeClass("active"),e("#J_il_list_"+_sw).removeClass("hide_it").siblings(".il_list").addClass("hide_it"),l(_sw),!i[_sw].firstLoad&&i[_sw].loaded?e("#J_il_list_"+u+" li").length>0?(e(".blank").addClass("hide_it"),i[_sw].isnomorepoint&&e("#nomorepoint").removeClass("hide_it")):(e(".blank").removeClass("hide_it"),e("#nomorepoint").addClass("hide_it")):f()});var c=function(){e(".time").each(function(){var t=n.getDate(e(this).text(),"!y-M-d").fmt;e(this).text(t)})};e(window).on("scroll",function(){var t=e("body").height();e(this).height()+e(this).scrollTop()>=t&&(s||(i[u].currentPage++,i[u].currentPage<=i[u].totalPage?(s=!0,h(i[u].currentPage,u),e(".load_more").show()):e(".load_more").hide()))}),e.getToken(function(){var t=document.URL;e.cookie.getH5("islogin")!=1?e.url.redirect(e.url.getTouchBaseUrl()+"login/index.html?gotourl="+encodeURIComponent(t)):l(1)});var p={track_tag_name:"5060",result:"",page_content:e("#all_score").text()||0,track_type:"1",message:""};r.shangbao(p)}),define("controller/my/point",function(){});